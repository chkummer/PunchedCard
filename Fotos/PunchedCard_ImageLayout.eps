%!PS-Adobe-2.0 EPSF-1.2
%%Title: PunchedCard (../Fotos/PunchedCard_Example_Image_Heart_DocOutput.eps)
%%Creator: punchcard.sh (https://github.com/chkummer/PunchedCard)
%%CreationDate: 16-Jun-2020
%%BoundingBox: 0 0 611 304
%%EndComments

%%BeginProcSet
% Outline of a punched card where the upper left corner was cut
/cardOutline
 { newpath
   0 0 0 setrgbcolor
   1.5 setlinewidth
   18 0 moveto
   495 0 rlineto
   513 18 18 270 360 arc
   0 198 rlineto
   513 216 18 0 90 arc
   -495  0 rlineto
   -18 -31.176 rlineto
   0 -184.824 rlineto
   18 18 18 180 270 arc
   closepath
   stroke } def
/Pos 0 def
/Hole 0 def

/hole
 { newpath moveto
   0 0 0 setrgbcolor
   0.25 setlinewidth
   -1.98 -4.5 rmoveto
   3.96 0 rlineto
   0 9 rlineto
   -3.96 0 rlineto
   0 -9 rlineto
   closepath
   gsave fill grestore } def

/punchHole
 { /XPos Pos 6.264 mul 11.808 add def
   XPos [180 162 144 126 108 90 72 54 36 18 0 198 216] Hole get hole } def

/DotMatrixPattern <00 00 00 00 00 00 00 00> def

/printDotMatrix
 { newpath
   /XPos Pos 6.264 mul 9 add def
   0.5 0.5 0.5 setrgbcolor
   gsave
   XPos 225 translate
   6 6 scale
   8 8 true
   [8 0 0 8 0 0] { DotMatrixPattern } imagemask
   grestore } bind def

/centreshow
 { /mystring exch def
   mystring stringwidth pop -2 div 0 rmoveto
   mystring show } def

/rightshow
 { dup stringwidth pop
   0 exch sub
   0 rmoveto
   show } def

/printGrid
 { 0.25 setlinewidth
   /PosStr 2 string def
   /Pos 1 def
   /Helvetica-Narrow findfont
   8 scalefont setfont
   % columns
   {
     /XPos Pos 6.264 mul 11.5 add def
     XPos -8 moveto 0 232 rlineto stroke
     XPos -15 moveto
     Pos PosStr cvs centreshow
     /Pos Pos 2 add def
     Pos 80 gt
     { exit } if
   } loop
   /Pos 2 def
   {
     /XPos Pos 6.264 mul 11.5 add def
     XPos -16 moveto 0 240 rlineto stroke
     XPos -23 moveto Pos PosStr cvs centreshow
     /Pos Pos 2 add def
     Pos 80 gt
     { exit } if
   } loop
   265 -32 moveto
   (Punching columns) centreshow
   % punch positions
   -8 216 moveto 525 0 rlineto stroke
   -9 213 moveto (12) rightshow
   -8 198 moveto 525 0 rlineto stroke
   -9 195 moveto (11) rightshow
   -8 180 moveto 525 0 rlineto stroke
   -9 177 moveto (0) rightshow
   -8 162 moveto 525 0 rlineto stroke
   -9 159 moveto (1) rightshow
   -8 144 moveto 525 0 rlineto stroke
   -9 141 moveto (2) rightshow
   -8 126 moveto 525 0 rlineto stroke
   -9 123 moveto (3) rightshow
   -8 108 moveto 525 0 rlineto stroke
   -9 105 moveto (4) rightshow
   -8 90 moveto 525 0 rlineto stroke
   -9 87 moveto (5) rightshow
   -8 72 moveto 525 0 rlineto stroke
   -9 69 moveto (6) rightshow
   -8 54 moveto 525 0 rlineto stroke
   -9 51 moveto (7) rightshow
   -8 36 moveto 525 0 rlineto stroke
   -9 33 moveto (8) rightshow
   -8 18 moveto 525 0 rlineto stroke
   -9 15 moveto (9) rightshow
   -20 80 moveto
   90 rotate
   (Punching positions) show
   90 neg rotate
   % bottom
   0.5 setlinewidth
   530 0 moveto
   17 0 rlineto
   0 15 rlineto
   stroke
   535 -2 moveto
   -5 2 rlineto
   5 2 rlineto
   stroke
   550 20 moveto
   90 rotate
   (Bottom) show
   90 neg rotate
   % top
   530 234 moveto
   17 0 rlineto
   0 -15 rlineto
   stroke
   535 232 moveto
   -5 2 rlineto
   5 2 rlineto
   stroke
   550 200 moveto
   90 rotate
   (Top) show
   90 neg rotate
   } def

%%EndProcSet

%%Page: 1
%%Card: 1
35 35 translate
cardOutline
printGrid
% Image-Input-Line: ''
/Pos 22 def
[1 2] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 23 def
[0 3] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 25 def
[4 11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 27 def
[5 11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 30 def
[6 12] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 32 def
[12] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 33 def
[7] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 34 def
[11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 36 def
[11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 37 def
[8] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 38 def
[0] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 40 def
[9 1] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 42 def
[0] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 43 def
[8] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 44 def
[11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 46 def
[11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 47 def
[7] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 48 def
[12] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 50 def
[6 12] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 53 def
[5 11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 55 def
[4 11] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 57 def
[0 3] { /Hole exch def punchHole } forall
% Image-Input-Line: ''
/Pos 58 def
[1 2] { /Hole exch def punchHole } forall
showpage
